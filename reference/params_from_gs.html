<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Download tabular survey parameters from Google Spreadsheets — params_from_gs • shinySurvey</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Download tabular survey parameters from Google Spreadsheets — params_from_gs" />
<meta property="og:description" content="When googlesheets4::gs4_has_token(), returns updated ss from sheet, otherwise local copy from last run.
See googlesheets4::read_sheet() for details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shinySurvey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/maxheld83/shinySurvey/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Download tabular survey parameters from Google Spreadsheets</h1>
    <small class="dont-index">Source: <a href='https://github.com/maxheld83/shinySurvey/blob/master/R/params.R'><code>R/params.R</code></a></small>
    <div class="hidden name"><code>params_from_gs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When <code><a href='https://rdrr.io/pkg/googlesheets4/man/gs4_has_token.html'>googlesheets4::gs4_has_token()</a></code>, returns updated <code>ss</code> from <code>sheet</code>, otherwise local copy from last run.
See <code><a href='https://rdrr.io/pkg/googlesheets4/man/range_read.html'>googlesheets4::read_sheet()</a></code> for details.</p>
    </div>

    <pre class="usage"><span class='fu'>params_from_gs</span>(
  <span class='no'>sheet</span>,
  <span class='kw'>ss</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"shinySurvey.ss"</span>),
  <span class='kw'>dir</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"shinySurvey.dir"</span>),
  <span class='kw'>update</span> <span class='kw'>=</span> <span class='kw pkg'>googlesheets4</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/googlesheets4/man/gs4_has_token.html'>gs4_has_token</a></span>(),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sheet</th>
      <td><p>Sheet to read, in the sense of "worksheet" or "tab". You can identify a sheet by name, with a string, or by position, with a number. Ignored if the sheet is specified via <code>range</code>. If neither argument specifies the sheet, defaults to the first visible sheet.</p></td>
    </tr>
    <tr>
      <th>ss</th>
      <td><p>Something that identifies a Google Sheet: its file ID, a URL from
which we can recover the ID, an instance of <code>googlesheets4_spreadsheet</code>
(returned by <code><a href='https://rdrr.io/pkg/googlesheets4/man/gs4_get.html'>gs4_get()</a></code>), or a <code><a href='https://googledrive.tidyverse.org/reference/dribble.html'>dribble</a></code>, which
is how googledrive represents Drive files. Processed through
<code><a href='https://rdrr.io/pkg/googlesheets4/man/as_sheets_id.html'>as_sheets_id()</a></code>.</p></td>
    </tr>
    <tr>
      <th>dir</th>
      <td><p><code>[character(1)]</code>
giving the directory to store serialised <code>sheet</code>.
Should be under version control.</p></td>
    </tr>
    <tr>
      <th>update</th>
      <td><p><code>[logical(1)]</code>
giving whether the file in <code>dir</code> should be updated.
Under the default <code><a href='https://rdrr.io/pkg/googlesheets4/man/gs4_has_token.html'>googlesheets4::gs4_has_token()</a></code>, the data will be updated whenever a token is available.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='https://rdrr.io/pkg/googlesheets4/man/range_read.html'>googlesheets4::read_sheet</a></code></p><dl'>
    <dt><code>range</code></dt><dd><p>A cell range to read from. If <code>NULL</code>, all non-empty cells are
read. Otherwise specify <code>range</code> as described in <a href='https://developers.google.com/sheets/api/guides/concepts#a1_notation'>Sheets A1 notation</a>
or using the helpers documented in <a href='https://rdrr.io/pkg/googlesheets4/man/cell-specification.html'>cell-specification</a>. Sheets uses
fairly standard spreadsheet range notation, although a bit different from
Excel. Examples of valid ranges: <code>"Sheet1!A1:B2"</code>, <code>"Sheet1!A:A"</code>,
<code>"Sheet1!1:2"</code>, <code>"Sheet1!A5:A"</code>, <code>"A1:B2"</code>, <code>"Sheet1"</code>. Interpreted
strictly, even if the range forces the inclusion of leading, trailing, or
embedded empty rows or columns. Takes precedence over <code>skip</code>, <code>n_max</code> and
<code>sheet</code>. Note <code>range</code> can be a named range, like <code>"sales_data"</code>, without
any cell reference.</p></dd>
    <dt><code>col_names</code></dt><dd><p><code>TRUE</code> to use the first row as column names, <code>FALSE</code> to get
default names, or a character vector to provide column names directly. If
user provides <code>col_types</code>, <code>col_names</code> can have one entry per column or one
entry per unskipped column.</p></dd>
    <dt><code>col_types</code></dt><dd><p>Column types. Either <code>NULL</code> to guess all from the
spreadsheet or a string of readr-style shortcodes, with one character or
code per column. If exactly one <code>col_type</code> is specified, it is recycled.
See Details for more.</p></dd>
    <dt><code>na</code></dt><dd><p>Character vector of strings to interpret as missing values. By
default, blank cells are treated as missing data.</p></dd>
    <dt><code>trim_ws</code></dt><dd><p>Logical. Should leading and trailing whitespace be trimmed
from cell contents?</p></dd>
    <dt><code>skip</code></dt><dd><p>Minimum number of rows to skip before reading anything, be it
column names or data. Leading empty rows are automatically skipped, so this
is a lower bound. Ignored if <code>range</code> is given.</p></dd>
    <dt><code>n_max</code></dt><dd><p>Maximum number of data rows to parse into the returned tibble.
Trailing empty rows are automatically skipped, so this is an upper bound on
the number of rows in the result. Ignored if <code>range</code> is given. <code>n_max</code> is
imposed locally, after reading all non-empty cells, so, if speed is an
issue, it is better to use <code>range</code>.</p></dd>
    <dt><code>guess_max</code></dt><dd><p>Maximum number of data rows to use for guessing column
types.</p></dd>
    <dt><code>.name_repair</code></dt><dd><p>Handling of column names. By default, googlesheets4
ensures column names are not empty and are unique. There is full support
for <code>.name_repair</code> as documented in <code><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble::tibble()</a></code>.</p></dd>
  
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='https://tibble.tidyverse.org/reference/tibble-package.html'>tibble</a></p>
    <h2 class="hasAnchor" id="storing-parameters-on-goooglesheets"><a class="anchor" href="#storing-parameters-on-goooglesheets"></a>Storing parameters on goooglesheets</h2>

    

<p>On the one hand, it is best to keep all survey application parameters (such as response options) under source control management (SCM).
On the other hand, some study collaborators may want to frequently and easily change parameters, and be unable or unwilling to use SCM.</p>
<p>This function allows such "non-tech" collaborators to edit survey parameters in a Google Spreadsheet online, while regularly committing their contributions to the source.</p>
<p>To use this function:</p><ol>
<li><p>Set up a Google Spreadsheet; authorize collaborators and optionally add write protections and notifications for the developer where appropriate.</p></li>
<li><p>Let collaborators edit the Google Spreadsheet.</p></li>
<li><p>Whenever an edit has been made, the developing collaborator can pull updates from Google Spreadsheets using this function from her local development machine (or wherever (<code><a href='https://rdrr.io/pkg/googlesheets4/man/gs4_has_token.html'>googlesheets4::gs4_has_token()</a></code>) and commit the result as a deparsed tibble.</p></li>
</ol>

<p>Ensure that changing entry parameters will not compromise data collection, the database schema or analysis.</p>
    <h2 class="hasAnchor" id="best-for-tabular-data"><a class="anchor" href="#best-for-tabular-data"></a>Best for tabular data</h2>

    

<p>This helper pertains only to those survey parameters best edited and represented in tabular form, such as dropdown options in different languages and the like.
Longer strings (several sentences), especially with markup, are awkward in spreadsheets and deparsed <code><a href='https://tibble.tidyverse.org/reference/tribble.html'>tibble::tribble()</a></code>s and better served via <code>strings_from_mdfile()</code>.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://www.maxheld.de'>Maximilian Held</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '583b2ffef107ab107b6c830882a47784',
    indexName: 'shinysurvey',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


